Initial version adapted from the Chapter 1 of the Martin Fowler's Refactoring book.